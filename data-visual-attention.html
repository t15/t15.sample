<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>9 Ways to Make Data Stand Out</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Noto+Sans+JP:wght@400;700&family=Space+Mono:wght@400;700&display=swap');

  :root {
    --bg: #0d0d0d;
    --panel: #161616;
    --panel-open: #1c1c1c;
    --border: #2a2a2a;
    --accent: #f0e040;
    --accent2: #ff5533;
    --text: #e8e8e8;
    --muted: #666;
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    background: var(--bg);
    color: var(--text);
    font-family: 'Space Mono', 'Noto Sans JP', monospace;
    min-height: 100vh;
    padding: 40px 20px 60px;
  }

  /* ── LANG TOGGLE ── */
  .lang-toggle {
    position: fixed;
    top: 20px; right: 20px;
    z-index: 100;
    display: flex;
    gap: 2px;
  }
  .lang-btn {
    background: var(--panel);
    border: 1px solid var(--border);
    color: var(--muted);
    font-family: 'Space Mono', monospace;
    font-size: 11px;
    letter-spacing: 0.1em;
    padding: 6px 12px;
    cursor: pointer;
    transition: all 0.15s;
  }
  .lang-btn.active { background: var(--accent); color: #000; border-color: var(--accent); font-weight: 700; }
  .lang-btn:hover:not(.active) { color: var(--text); border-color: #444; }

  /* ── HEADER ── */
  header { text-align: center; margin-bottom: 52px; }
  .header-label { font-size: 10px; letter-spacing: 0.35em; color: var(--accent); text-transform: uppercase; margin-bottom: 12px; }
  h1 { font-family: 'Bebas Neue', sans-serif; font-size: clamp(38px, 7vw, 84px); letter-spacing: 0.05em; line-height: 0.95; color: #fff; }
  h1 span { color: var(--accent); }
  .subtitle { font-size: 11px; color: var(--muted); margin-top: 14px; letter-spacing: 0.08em; }

  /* ── GRID: 3 cols → 1 col only ── */
  .grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 2px;
    max-width: 1100px;
    margin: 0 auto;
  }
  /* single breakpoint: below ~720px → 1 column */
  @media (max-width: 719px) {
    .grid { grid-template-columns: 1fr; }
  }

  /* ── CARD ── */
  .card {
    background: var(--panel);
    border: 1px solid var(--border);
    position: relative;
    overflow: hidden;
    cursor: pointer;
    transition: background 0.2s, border-color 0.2s;
    animation: fadeUp 0.4s both;
  }
  .card:hover { background: #1a1a1a; border-color: #333; }
  .card.open  { background: var(--panel-open); border-color: var(--accent); }

  .card-inner { padding: 28px 24px 18px; }

  .card-num {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 54px; color: #222; line-height: 1;
    position: absolute; top: 8px; right: 14px;
    pointer-events: none; transition: color 0.2s;
  }
  .card.open .card-num { color: #2e2e00; }

  .card-title { font-size: 12px; font-weight: 700; color: var(--accent); letter-spacing: 0.18em; text-transform: uppercase; margin-bottom: 12px; position: relative; z-index: 1; }
  .card-desc  { font-size: 11.5px; color: #999; line-height: 1.75; margin-bottom: 16px; position: relative; z-index: 1; }

  .visual { height: 60px; display: flex; align-items: center; gap: 6px; position: relative; z-index: 1; }

  .expand-hint { font-size: 9px; letter-spacing: 0.15em; color: #444; text-align: right; padding: 8px 24px 10px; transition: color 0.2s; }
  .card:hover .expand-hint { color: #666; }
  .card.open  .expand-hint { color: var(--accent); }

  .detail { max-height: 0; overflow: hidden; transition: max-height 0.42s cubic-bezier(0.4,0,0.2,1), opacity 0.3s; opacity: 0; }
  .card.open .detail { max-height: 500px; opacity: 1; }

  .detail-inner { border-top: 1px solid #252525; padding: 18px 24px 24px; }
  .detail-inner h3 { font-size: 10px; letter-spacing: 0.25em; color: var(--accent2); text-transform: uppercase; margin-bottom: 10px; }
  .detail-inner p  { font-size: 11.5px; color: #bbb; line-height: 1.85; margin-bottom: 14px; }

  .tags { display: flex; flex-wrap: wrap; gap: 6px; margin-top: 12px; }
  .tag  { background: #1e1e1e; border: 1px solid #2e2e2e; color: #777; font-size: 10px; letter-spacing: 0.06em; padding: 3px 9px; border-radius: 2px; }

  /* ── VISUALS ── */
  .v-length .bar { width: 10px; background: var(--accent); border-radius: 2px; }
  .v-length .bar:nth-child(1){height:20px} .v-length .bar:nth-child(2){height:36px}
  .v-length .bar:nth-child(3){height:54px;background:var(--accent2);width:13px}
  .v-length .bar:nth-child(4){height:28px} .v-length .bar:nth-child(5){height:14px}

  .v-width { flex-direction:column; align-items:flex-start; gap:5px; }
  .v-width .wbar { height:10px; background:var(--accent); border-radius:2px; }
  .v-width .wbar:nth-child(1){width:38px} .v-width .wbar:nth-child(2){width:80px;background:var(--accent2)}
  .v-width .wbar:nth-child(3){width:52px} .v-width .wbar:nth-child(4){width:28px}

  .v-orient { gap:12px; }
  .v-orient .line { width:3px; height:42px; background:var(--accent); border-radius:2px; transform-origin:center; }
  .v-orient .line:nth-child(1){transform:rotate(0deg)} .v-orient .line:nth-child(2){transform:rotate(30deg)}
  .v-orient .line:nth-child(3){transform:rotate(60deg);background:var(--accent2);height:52px;width:5px}
  .v-orient .line:nth-child(4){transform:rotate(90deg)} .v-orient .line:nth-child(5){transform:rotate(-30deg)}

  .v-shape { gap:12px; align-items:center; }
  .v-shape .sq { width:26px;height:26px;background:var(--accent);opacity:.7 }
  .v-shape .ci { width:26px;height:26px;border-radius:50%;background:var(--accent);opacity:.7 }
  .v-shape .tr { width:0;height:0;border-left:13px solid transparent;border-right:13px solid transparent;border-bottom:26px solid var(--accent);opacity:.7 }
  .v-shape .st { font-size:28px;line-height:1;color:var(--accent2) }

  .v-enclose { gap:8px; align-items:center; }
  .v-enclose .dot { width:9px;height:9px;border-radius:50%;background:var(--accent);opacity:.4 }
  .v-enclose .grp { display:flex;gap:4px;align-items:center;border:2px solid var(--accent2);padding:5px 7px;border-radius:4px }
  .v-enclose .grp .dot { opacity:1;background:var(--accent2) }

  .v-size { gap:10px; align-items:center; }
  .v-size .b { border-radius:50%;background:var(--accent);opacity:.8;flex-shrink:0 }
  .v-size .b:nth-child(1){width:12px;height:12px} .v-size .b:nth-child(2){width:22px;height:22px}
  .v-size .b:nth-child(3){width:48px;height:48px;background:var(--accent2);opacity:1} .v-size .b:nth-child(4){width:18px;height:18px}

  .v-pos { position:relative;width:160px;height:60px; }
  .v-pos .dot { width:9px;height:9px;border-radius:50%;background:var(--accent);position:absolute;opacity:.5 }
  .v-pos .dot.hi { background:var(--accent2);opacity:1;width:13px;height:13px;top:2px;left:108px }
  .v-pos .dot:nth-child(1){top:30px;left:8px} .v-pos .dot:nth-child(2){top:20px;left:38px}
  .v-pos .dot:nth-child(3){top:40px;left:62px} .v-pos .dot:nth-child(4){top:44px;left:88px}
  .v-pos .dot:nth-child(6){top:14px;left:132px}

  .v-group { gap:14px; align-items:center; }
  .v-group .cluster { display:flex;gap:4px;flex-wrap:wrap;width:42px }
  .v-group .gdot { width:9px;height:9px;border-radius:50%;background:var(--accent);opacity:.5 }
  .v-group .cluster.active .gdot { background:var(--accent2);opacity:1 }

  .v-color { gap: 18px; align-items: center; }
  .v-color .hue-row { display: flex; gap: 5px; align-items: flex-end; }
  .v-color .hbar { width:14px; height:40px; border-radius:3px; }
  .v-color .hbar.hi { height:54px; width:18px; }
  .v-color .sep { width:1px; height:44px; background:#333; }
  .v-color .int-row { display: flex; gap: 5px; align-items: center; }
  .v-color .ibar { width:14px; height:40px; border-radius:3px; }

  .v-motion { gap: 16px; align-items: center; }
  .v-motion .dot-still { width:14px;height:14px;border-radius:50%;background:var(--accent);opacity:.35 }
  .v-motion .dot-trail { display:flex;align-items:center;gap:4px }
  .v-motion .trail { width:9px;height:9px;border-radius:50%;background:var(--accent2) }
  .v-motion .trail:nth-child(1){ opacity:0.2 }
  .v-motion .trail:nth-child(2){ opacity:0.5 }
  .v-motion .trail:nth-child(3){ opacity:1; animation:pulse 1.4s ease-in-out infinite }

  @keyframes pulse {
    0%,100%{ transform:scale(1);   opacity:1 }
    50%    { transform:scale(1.6); opacity:0.5 }
  }

  /* ── REFERENCES ── */
  .references {
    max-width: 1100px;
    margin: 48px auto 0;
    border-top: 1px solid #222;
    padding-top: 32px;
  }
  .ref-title {
    font-size: 10px;
    letter-spacing: 0.3em;
    color: var(--accent);
    text-transform: uppercase;
    margin-bottom: 20px;
  }
  .ref-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 2px;
  }
  @media (max-width: 719px) {
    .ref-grid { grid-template-columns: 1fr; }
  }

  .ref-item {
    background: var(--panel);
    border: 1px solid var(--border);
    padding: 14px 16px;
    text-decoration: none;
    display: block;
    transition: background 0.2s, border-color 0.2s;
    cursor: pointer;
    position: relative;
  }
  .ref-item:hover {
    background: #1a1a1a;
    border-color: #444;
  }
  .ref-item:hover .ref-name { color: var(--accent); }
  .ref-link-icon {
    position: absolute;
    top: 12px; right: 14px;
    font-size: 10px;
    color: #444;
    transition: color 0.2s;
  }
  .ref-item:hover .ref-link-icon { color: var(--accent); }

  .ref-author {
    font-size: 9px;
    letter-spacing: 0.12em;
    color: var(--accent2);
    text-transform: uppercase;
    margin-bottom: 5px;
    padding-right: 20px;
  }
  .ref-name {
    font-size: 11.5px;
    color: #ccc;
    line-height: 1.5;
    margin-bottom: 6px;
    transition: color 0.2s;
    padding-right: 20px;
  }
  .ref-meta {
    font-size: 10px;
    color: #555;
    letter-spacing: 0.03em;
    line-height: 1.6;
  }

  footer { text-align:center; margin-top:40px; font-size:10px; color:#2d2d2d; letter-spacing:0.2em; }

  @keyframes fadeUp { from{opacity:0;transform:translateY(14px)} to{opacity:1;transform:translateY(0)} }
  .card:nth-child(1){animation-delay:.05s} .card:nth-child(2){animation-delay:.10s}
  .card:nth-child(3){animation-delay:.15s} .card:nth-child(4){animation-delay:.20s}
  .card:nth-child(5){animation-delay:.25s} .card:nth-child(6){animation-delay:.30s}
  .card:nth-child(7){animation-delay:.35s} .card:nth-child(8){animation-delay:.40s}
  .card:nth-child(9){animation-delay:.45s}
</style>
</head>
<body>

<div class="lang-toggle">
  <button class="lang-btn active" onclick="setLang('en')">EN</button>
  <button class="lang-btn" onclick="setLang('ja')">JA</button>
</div>

<header>
  <div class="header-label">Pre-attentive Attributes · Data Visualization</div>
  <h1 id="h1"></h1>
  <p class="subtitle" id="subtitle"></p>
</header>

<div class="grid" id="grid"></div>
<div class="references" id="refs"></div>
<footer>PRE-ATTENTIVE ATTRIBUTES · DATA VISUALIZATION FUNDAMENTALS</footer>

<script>
const DATA = [
  {
    num:"01",
    visual:`<div class="visual v-length"><div class="bar"></div><div class="bar"></div><div class="bar"></div><div class="bar"></div><div class="bar"></div></div>`,
    en:{ title:"Length", short:"Bar length encodes magnitude — the longer, the more.", why:"Length is one of the most accurate pre-attentive attributes. Humans are exceptionally good at comparing lengths, making it the backbone of bar charts and Gantt charts. Deviating from a zero baseline can distort perception dramatically.", tags:["Bar Chart","Gantt Chart","Timeline"] },
    ja:{ title:"Length · 長さ", short:"棒の長さで量の大小を表現。最も直感的な比較手法。", why:"長さは最も正確に知覚できる前注意的属性のひとつです。棒グラフやガントチャートの基本原理であり、ゼロ基準線からのずれは知覚の歪みを引き起こします。", tags:["棒グラフ","ガントチャート","タイムライン"] }
  },
  {
    num:"02",
    visual:`<div class="visual v-width"><div class="wbar"></div><div class="wbar"></div><div class="wbar"></div><div class="wbar"></div></div>`,
    en:{ title:"Width", short:"Thicker strokes carry more visual weight and emphasis.", why:"Width complements length to create two-dimensional area comparisons. Frequently used in Marimekko charts to represent a secondary variable, or to draw attention to a specific data series through boldness.", tags:["Marimekko Chart","Area Chart","Emphasis"] },
    ja:{ title:"Width · 太さ", short:"線や棒の幅で重みや強調度の違いを表現する。", why:"太さは長さを補い、2次元の面積比較を可能にします。マリメッコチャートでは副変数の表現に使われ、特定のデータ系列を強調する手段としても機能します。", tags:["マリメッコ","面積チャート","強調"] }
  },
  {
    num:"03",
    visual:`<div class="visual v-orient"><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div></div>`,
    en:{ title:"Orientation", short:"Angle and direction distinguish categories at a glance.", why:"Orientation is particularly powerful in texture-based visualizations and wind/flow maps. A single element rotated differently from its neighbors will instantly attract the eye, making it effective for outlier detection.", tags:["Wind Map","Texture","Outlier Detection"] },
    ja:{ title:"Orientation · 向き", short:"角度・方向の違いでカテゴリや外れ値を瞬時に識別。", why:"向きはテクスチャベースの可視化や風・流れのマップで特に有効です。周囲と異なる角度を持つ要素は即座に目を引き、外れ値の検出に効果的です。", tags:["風マップ","テクスチャ","外れ値検出"] }
  },
  {
    num:"04",
    visual:`<div class="visual v-shape"><div class="sq"></div><div class="ci"></div><div class="tr"></div><div class="st">★</div></div>`,
    en:{ title:"Shape", short:"Distinct forms encode categorical differences without color.", why:"Shape is invaluable when color cannot be relied upon (e.g., print, colorblind audiences). Using 5 or fewer distinct shapes per chart keeps the legend manageable. Combining shape with color amplifies differentiation.", tags:["Scatter Plot","Symbol Map","Accessibility"] },
    ja:{ title:"Shape · 形", short:"丸・三角・星など形の違いで色なしにカテゴリを識別。", why:"色が使えない環境（印刷、色覚異常への配慮）で特に有効です。1チャートあたり5種類以内の形に抑えると知覚精度が保たれます。色と組み合わせると区別力がさらに高まります。", tags:["散布図","シンボルマップ","アクセシビリティ"] }
  },
  {
    num:"05",
    visual:`<div class="visual v-enclose"><div class="dot"></div><div class="dot"></div><div class="grp"><div class="dot"></div><div class="dot"></div><div class="dot"></div></div><div class="dot"></div><div class="dot"></div></div>`,
    en:{ title:"Enclosure", short:"Borders and backgrounds group elements into meaningful clusters.", why:"Enclosure leverages Gestalt's law of closure — the brain perceives enclosed items as belonging together. Used in small multiples, dashboard panels, and annotation boxes to create clear visual regions without clutter.", tags:["Small Multiples","Dashboard","Gestalt"] },
    ja:{ title:"Enclosure · 囲み", short:"枠や背景色でグループを示し、特定のデータ群を強調。", why:"ゲシュタルトの「閉合の法則」を利用します。囲まれた要素は同一グループとして知覚されます。スモールマルチプルやダッシュボードパネル、注釈ボックスで視覚的領域を明確に区切るのに有効です。", tags:["スモールマルチプル","ダッシュボード","ゲシュタルト"] }
  },
  {
    num:"06",
    visual:`<div class="visual v-size"><div class="b"></div><div class="b"></div><div class="b"></div><div class="b"></div></div>`,
    en:{ title:"Size", short:"Area encodes quantity — larger means more.", why:"Size works well for broad magnitude differences but degrades for small distinctions (humans struggle to compare areas precisely). Bubble charts and treemaps exploit size — always pair with labels or tooltips for accuracy.", tags:["Bubble Chart","Treemap","Proportional Symbol"] },
    ja:{ title:"Size · サイズ", short:"要素の大きさで量の多少を一目で伝える。", why:"大まかな量の差を伝えるのに有効ですが、細かな差の比較は苦手です（人間は面積を正確に比較しにくい）。バブルチャートやツリーマップで活用しますが、ラベルや注釈との併用が精度を補います。", tags:["バブルチャート","ツリーマップ","比例シンボル"] }
  },
  {
    num:"07",
    visual:`<div class="visual v-pos"><div class="dot"></div><div class="dot"></div><div class="dot"></div><div class="dot"></div><div class="dot hi"></div><div class="dot"></div></div>`,
    en:{ title:"Position", short:"X/Y coordinates are the most precise attribute for comparison.", why:"Position along a common scale is the highest-accuracy pre-attentive attribute — hence why scatter plots and dot plots outperform pie charts for precise comparisons. Aligning marks to a shared baseline multiplies readability.", tags:["Scatter Plot","Dot Plot","Axis Alignment"] },
    ja:{ title:"Position · 位置", short:"X・Y軸上の配置は最も精度の高い比較手法。", why:"共通スケール上の位置は最も正確に知覚される前注意的属性です。散布図やドットプロットが円グラフより比較精度で優れるのはこのためです。共通ベースラインへの整列が可読性を大幅に高めます。", tags:["散布図","ドットプロット","軸の整列"] }
  },
  {
    num:"08",
    visual:`<div class="visual v-color">
      <div class="hue-row">
        <div class="hbar" style="background:#4fc3f7"></div>
        <div class="hbar" style="background:#81c784"></div>
        <div class="hbar hi" style="background:#ff5533"></div>
        <div class="hbar" style="background:#ce93d8"></div>
      </div>
      <div class="sep"></div>
      <div class="int-row">
        <div class="ibar" style="background:rgba(240,224,64,.15)"></div>
        <div class="ibar" style="background:rgba(240,224,64,.40)"></div>
        <div class="ibar" style="background:rgba(240,224,64,.70)"></div>
        <div class="ibar" style="background:rgba(240,224,64,1)"></div>
      </div>
    </div>`,
    en:{
      title:"Color",
      short:"Hue separates categories; intensity encodes quantity.",
      why:`Color encompasses two distinct pre-attentive dimensions that serve different purposes:<br><br><strong style="color:#e8e8e8">Hue</strong> — ideal for nominal (unordered) categories. Limit to 6–8 distinct hues; use colorblind-safe palettes (e.g., ColorBrewer).<br><br><strong style="color:#e8e8e8">Intensity</strong> — best for sequential or quantitative data. A single-hue gradient (light → dark) is often easier to read than multi-hue schemes. Used in heatmaps and choropleths.`,
      tags:["Hue","Intensity","Heatmap","Choropleth","ColorBrewer","Accessibility"]
    },
    ja:{
      title:"Color · 色",
      short:"色相でカテゴリを、濃淡で量を表現する。",
      why:`色には用途の異なる2つの前注意的次元があります：<br><br><strong style="color:#e8e8e8">色相（Hue）</strong> — 名義データ（順序なしカテゴリ）に最適。6〜8色以内に抑え、ColorBrewerなど色盲対応パレットを推奨。<br><br><strong style="color:#e8e8e8">濃淡（Intensity）</strong> — 順序・量的データに最適。単色グラデーション（淡→濃）は多色より読み取りやすい。ヒートマップやコロプレスマップで活用。`,
      tags:["色相","濃淡","ヒートマップ","コロプレス","ColorBrewer","アクセシビリティ"]
    }
  },
  {
    num:"09",
    visual:`<div class="visual v-motion">
      <div class="dot-still"></div>
      <div class="dot-still"></div>
      <div class="dot-trail"><div class="trail"></div><div class="trail"></div><div class="trail"></div></div>
      <div class="dot-still"></div>
      <div class="dot-still"></div>
    </div>`,
    en:{
      title:"Motion",
      short:"Movement and flicker capture attention before anything else.",
      why:"Motion is arguably the most powerful pre-attentive attribute — the human visual system evolved to detect movement instantly as a survival mechanism. Even a slow pulse or subtle animation will dominate a static display. Use it sparingly: one animated element draws the eye effectively; many create chaos. Best applied to live data, alerts, and guided storytelling.",
      tags:["Animation","Flicker","Live Data","Storytelling","Dashboard Alerts"]
    },
    ja:{
      title:"Motion · 動き",
      short:"動きと点滅は他のどの属性よりも先に注意を引く。",
      why:"動きはおそらく最も強力な前注意的属性です。人間の視覚系は生存本能として動きを瞬時に検出するよう進化しています。わずかなパルスやアニメーションでも静的な表示を圧倒します。使いすぎは禁物で、1つの動く要素が効果的に目を引きますが、多用すると混乱を招きます。ライブデータ・アラート・ストーリーテリングに最適。",
      tags:["アニメーション","点滅","ライブデータ","ストーリーテリング","ダッシュボードアラート"]
    }
  }
];

const REFS = {
  en: [
    {
      author:"Colin Ware",
      name:"Information Visualization: Perception for Design",
      meta:"4th ed., 2020 · Morgan Kaufmann · The foundational academic treatment of pre-attentive attributes and visual perception.",
      url:"https://www.sciencedirect.com/book/9780128128756/information-visualization"
    },
    {
      author:"Stephen Few",
      name:"Now You See It: Simple Visualization Techniques for Quantitative Analysis",
      meta:"2009 · Analytics Press · Practical classification of pre-attentive attributes for business dashboards.",
      url:"https://www.perceptualedge.com/library.php"
    },
    {
      author:"Edward Tufte",
      name:"The Visual Display of Quantitative Information",
      meta:"2nd ed., 2001 · Graphics Press · Classic reference on data-ink ratio and graphical integrity.",
      url:"https://www.edwardtufte.com/book/the-visual-display-of-quantitative-information/"
    },
    {
      author:"Alberto Cairo",
      name:"The Functional Art: An Introduction to Information Graphics and Visualization",
      meta:"2012 · New Riders · Bridges cognitive science and visualization practice.",
      url:"http://www.thefunctionalart.com"
    },
    {
      author:"Anne Treisman & Garry Gelade",
      name:"A Feature-Integration Theory of Attention",
      meta:"Cognitive Psychology, 12(1), 1980 · The original scientific paper establishing pre-attentive processing theory.",
      url:"https://scholar.google.com/scholar?q=A+Feature-Integration+Theory+of+Attention+Treisman+Gelade+1980"
    },
    {
      author:"Tamara Munzner",
      name:"Visualization Analysis and Design",
      meta:"2014 · CRC Press / A K Peters · Rigorous framework covering channels, marks, and perception.",
      url:"https://www.cs.ubc.ca/~tmm/vadbook/"
    },
  ],
  ja: [
    {
      author:"Colin Ware",
      name:"Information Visualization: Perception for Design",
      meta:"原著第4版 2020年 · Morgan Kaufmann · 前注意的属性と視覚知覚の学術的基礎文献。",
      url:"https://www.sciencedirect.com/book/9780128128756/information-visualization"
    },
    {
      author:"Stephen Few",
      name:"Now You See It",
      meta:"2009年 · Analytics Press · 前注意的属性のビジネス向け実用的な分類を提唱。著者サイトに豊富な資料あり。",
      url:"https://www.perceptualedge.com/library.php"
    },
    {
      author:"Edward Tufte",
      name:"The Visual Display of Quantitative Information",
      meta:"第2版 2001年 · Graphics Press · データインク比とグラフィカルな誠実さに関する古典的名著。",
      url:"https://www.edwardtufte.com/book/the-visual-display-of-quantitative-information/"
    },
    {
      author:"Alberto Cairo",
      name:"The Functional Art",
      meta:"2012年 · New Riders · 認知科学と可視化実践を橋渡しする一冊。著者ブログも参考になる。",
      url:"http://www.thefunctionalart.com"
    },
    {
      author:"Anne Treisman & Garry Gelade",
      name:"A Feature-Integration Theory of Attention",
      meta:"Cognitive Psychology, 12(1), 1980年 · 前注意的処理理論を確立した原著論文。Google Scholar で全文検索可能。",
      url:"https://scholar.google.com/scholar?q=A+Feature-Integration+Theory+of+Attention+Treisman+Gelade+1980"
    },
    {
      author:"Tamara Munzner",
      name:"Visualization Analysis and Design",
      meta:"2014年 · CRC Press · チャンネル・マーク・知覚を体系的に扱う教科書。著者サイトに補足資料あり。",
      url:"https://www.cs.ubc.ca/~tmm/vadbook/"
    },
  ]
};

let lang = 'en';
const openSet = new Set();

function setLang(l) {
  lang = l;
  document.querySelectorAll('.lang-btn').forEach(b =>
    b.classList.toggle('active', b.textContent.trim().toLowerCase() === l)
  );
  renderHeader();
  renderCards();
  renderRefs();
}

function renderHeader() {
  const isEn = lang === 'en';
  document.getElementById('h1').innerHTML = isEn
    ? '9 WAYS TO MAKE<br><span>DATA STAND OUT</span>'
    : 'データを目立たせる<br><span>9</span>の方法';
  document.getElementById('subtitle').textContent = isEn
    ? 'Visual properties the human brain processes instantly — before conscious thought'
    : '人間の脳が無意識に即座に処理する視覚的属性';
}

function renderCards() {
  const isEn = lang === 'en';
  const grid = document.getElementById('grid');
  grid.innerHTML = '';
  DATA.forEach((c, i) => {
    const d = isEn ? c.en : c.ja;
    const isOpen = openSet.has(i);
    const el = document.createElement('div');
    el.className = 'card' + (isOpen ? ' open' : '');
    el.style.animationDelay = (0.05 + i * 0.05) + 's';
    const openLabel  = isEn ? '▲ CLOSE' : '▲ 閉じる';
    const closeLabel = isEn ? '▼ DETAILS' : '▼ 詳細';
    el.innerHTML = `
      <div class="card-inner">
        <div class="card-num">${c.num}</div>
        <div class="card-title">${d.title}</div>
        <div class="card-desc">${d.short}</div>
        ${c.visual}
      </div>
      <div class="expand-hint">${isOpen ? openLabel : closeLabel}</div>
      <div class="detail">
        <div class="detail-inner">
          <h3>${isEn ? 'Why it works' : 'なぜ効果的か'}</h3>
          <p>${d.why}</p>
          <div class="tags">${d.tags.map(t => `<span class="tag">${t}</span>`).join('')}</div>
        </div>
      </div>
    `;
    el.addEventListener('click', () => {
      const nowOpen = el.classList.toggle('open');
      nowOpen ? openSet.add(i) : openSet.delete(i);
      el.querySelector('.expand-hint').textContent = nowOpen ? openLabel : closeLabel;
    });
    grid.appendChild(el);
  });
}

function renderRefs() {
  const isEn = lang === 'en';
  const refs = REFS[lang];
  document.getElementById('refs').innerHTML = `
    <div class="ref-title">${isEn ? 'References & Further Reading' : '参考文献・出典'}</div>
    <div class="ref-grid">
      ${refs.map(r => `
        <a class="ref-item" href="${r.url}" target="_blank" rel="noopener noreferrer">
          <span class="ref-link-icon">↗</span>
          <div class="ref-author">${r.author}</div>
          <div class="ref-name">${r.name}</div>
          <div class="ref-meta">${r.meta}</div>
        </a>
      `).join('')}
    </div>
  `;
}

renderHeader();
renderCards();
renderRefs();
</script>
</body>
</html>
