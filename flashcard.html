<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>シンプル英字フラッシュカード</title>
<style>
  :root{
    --bg:#0f1724;
    --card:#0b1220;
    --accent:#60a5fa;
    --muted:#94a3b8;
    --white:#ffffff;
  }
  html,body{
    height:100%;
    margin:0;
    font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Hiragino Kaku Gothic ProN", "Noto Sans JP", sans-serif;
    background: linear-gradient(180deg,#071226 0%, #0f2a3e 100%);
    color:var(--white);
    -webkit-font-smoothing:antialiased;
    display:flex;
    align-items:center;
    justify-content:center;
    padding:24px;
    box-sizing:border-box;
  }
  .container{
    width:100%;
    max-width:820px;
    background:linear-gradient(180deg,rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    border-radius:12px;
    padding:20px;
    box-shadow: 0 6px 30px rgba(2,6,23,0.6);
  }
  header{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:12px;}
  h1{font-size:18px;margin:0;color:var(--accent)}
  .meta{color:var(--muted);font-size:13px}
  .card{
    height:220px;
    border-radius:10px;
    background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    display:flex;
    align-items:center;
    justify-content:center;
    margin-bottom:12px;
    box-shadow: inset 0 1px 0 rgba(255,255,255,0.02);
  }
  .letter{
    font-size:124px;
    letter-spacing:6px;
    user-select:none;
  }
  .controls{
    display:flex;
    gap:8px;
    align-items:center;
    flex-wrap:wrap;
    margin-bottom:12px;
  }
  button{
    background:transparent;
    border:1px solid rgba(255,255,255,0.08);
    color:var(--white);
    padding:8px 12px;
    border-radius:8px;
    cursor:pointer;
    font-size:14px;
  }
  button.primary{
    background:var(--accent);
    color:#03203a;
    border:0;
    font-weight:600;
  }
  .small{
    font-size:13px;color:var(--muted);
  }
  .inputs{
    display:flex;
    gap:12px;
    align-items:flex-start;
    flex-wrap:wrap;
  }
  textarea{
    width:360px;
    max-width:100%;
    min-height:84px;
    resize:vertical;
    padding:8px;
    border-radius:8px;
    border:1px solid rgba(255,255,255,0.06);
    background:transparent;
    color:var(--white);
    font-size:14px;
  }
  input[type="file"]{color:var(--muted);}
  .row{display:flex;gap:8px;align-items:center;}
  .info{font-size:13px;color:var(--muted);margin-top:6px;}
  footer{display:flex;justify-content:space-between;align-items:center;margin-top:10px;}
  @media (max-width:520px){
    .letter{font-size:84px}
    .card{height:160px}
  }
</style>
</head>
<body>
  <div class="container" role="application" aria-label="Flashcards">
    <header>
      <div>
        <h1>シンプル 英字フラッシュカード</h1>
        <div class="meta">Space / Enter で次へ • ファイル/テキストで任意の語を読み込み可能</div>
      </div>
      <div class="small">デフォルト: A–Z (大/小ランダム)</div>
    </header>

    <main>
      <div class="card" id="card" tabindex="0" aria-live="polite" role="status">
        <div class="letter" id="display">A</div>
      </div>

      <div class="controls" role="toolbar" aria-label="controls">
        <button id="nextBtn" class="primary">次（ランダム表示）</button>
        <button id="resetBtn" title="表示対象をデフォルト（A–Z）に戻す">デフォルトに戻す</button>
        <label class="row small" title="デフォルト（A-Z）を使用しているときだけ大/小ランダム">
          <input type="checkbox" id="randCase" checked />
          &nbsp;大/小ランダム（A–Z用）
        </label>
        <div class="small" id="countInfo" aria-live="polite">項目数: 26</div>
      </div>

      <section class="inputs" aria-label="data-inputs">
        <div>
          <div style="margin-bottom:6px" class="small">テキスト入力（改行・カンマ区切り可）</div>
          <textarea id="textInput" placeholder="例: cat, dog, apple または 改行で複数行"></textarea>
          <div style="margin-top:6px;display:flex;gap:8px">
            <button id="applyText">このテキストを使用</button>
            <button id="clearInput">入力をクリア</button>
          </div>
        </div>

        <div>
          <div class="small" style="margin-bottom:6px">テキストファイルを読み込む (.txt)</div>
          <input id="fileInput" type="file" accept=".txt,text/plain" />
          <div style="margin-top:8px">
            <button id="loadFileBtn">ファイルから読み込む</button>
          </div>
        </div>
      </section>

      <div class="info" id="lastInfo">最後に表示したもの: --</div>
    </main>

    <footer>
      <div class="small">保存不要 — ローカルで開いて使えます</div>
      <div class="small">ショートカット: Space / Enter = 次</div>
    </footer>
  </div>

<script>
(() => {
  // デフォルトデータ (A-Z)
  const DEFAULT_ITEMS = Array.from({length:26}, (_,i) => String.fromCharCode(65 + i)); // ["A","B",...,"Z"]

  // state
  let items = DEFAULT_ITEMS.slice(); // 現在の項目配列（表示対象）
  const displayEl = document.getElementById('display');
  const nextBtn = document.getElementById('nextBtn');
  const resetBtn = document.getElementById('resetBtn');
  const countInfo = document.getElementById('countInfo');
  const lastInfo = document.getElementById('lastInfo');
  const randCaseCheckbox = document.getElementById('randCase');
  const textInput = document.getElementById('textInput');
  const applyText = document.getElementById('applyText');
  const clearInput = document.getElementById('clearInput');
  const fileInput = document.getElementById('fileInput');
  const loadFileBtn = document.getElementById('loadFileBtn');
  const card = document.getElementById('card');

  // ユーティリティ: items 数表示更新
  function updateCount() {
    countInfo.textContent = '項目数: ' + items.length;
  }

  // utility: pick random element from array
  function pickRandom(arr) {
    if (!arr.length) return '';
    return arr[Math.floor(Math.random() * arr.length)];
  }

  // display a value; apply default-case randomization if using default items and checkbox enabled
  function showRandom() {
    if (!items.length) {
      displayEl.textContent = '';
      lastInfo.textContent = '最後に表示したもの: — （項目がありません）';
      return;
    }

    let value = pickRandom(items);

    // If current items === DEFAULT_ITEMS (by length and contents) and randCase enabled => randomize case
    const isDefaultSet = items.length === DEFAULT_ITEMS.length &&
                         items.every((v,i) => v === DEFAULT_ITEMS[i]);

    if (isDefaultSet && randCaseCheckbox.checked && /^[A-Za-z]$/.test(value)) {
      // random uppercase/lowercase
      value = Math.random() < 0.5 ? value.toUpperCase() : value.toLowerCase();
    }

    displayEl.textContent = value;
    lastInfo.textContent = '最後に表示したもの: ' + value;
    // focus for keyboard convenience
    card.focus();
  }

  // parse user-provided text into an array of items
  function parseTextToItems(text) {
    if (!text) return [];
    // split on newlines or commas or semicolons; trim each; remove empty
    const parts = text.split(/[\r\n,;]+/).map(s => s.trim()).filter(Boolean);
    return parts;
  }

  // apply textarea input as items
  function applyTextInput() {
    const parsed = parseTextToItems(textInput.value);
    if (!parsed.length) {
      alert('読み込める項目が見つかりませんでした。テキストを確認してください。');
      return;
    }
    items = parsed;
    updateCount();
    showRandom();
  }

  // load file input (reads as text)
  function loadFile() {
    const f = fileInput.files && fileInput.files[0];
    if (!f) {
      alert('まずファイルを選択してください（.txt）');
      return;
    }
    const reader = new FileReader();
    reader.onload = e => {
      const text = String(e.target.result || '');
      const parsed = parseTextToItems(text);
      if (!parsed.length) {
        alert('ファイルの中に項目が見つかりませんでした。行やカンマ区切りで文字列を入れてください。');
        return;
      }
      items = parsed;
      updateCount();
      showRandom();
      // clear file input so same file can be reselected if desired
      fileInput.value = '';
    };
    reader.onerror = () => alert('ファイル読み込み中にエラーが発生しました。');
    reader.readAsText(f, 'UTF-8');
  }

  // reset to default A-Z
  function resetToDefault() {
    items = DEFAULT_ITEMS.slice();
    updateCount();
    showRandom();
  }

  // event bindings
  nextBtn.addEventListener('click', showRandom);
  resetBtn.addEventListener('click', resetToDefault);
  applyText.addEventListener('click', applyTextInput);
  clearInput.addEventListener('click', () => textInput.value = '');
  loadFileBtn.addEventListener('click', loadFile);
  fileInput.addEventListener('change', () => {/* no-op: handled by button */});

  // keyboard: Space / Enter => next
  window.addEventListener('keydown', (ev) => {
    // ignore if typing in an input / textarea
    const tag = (ev.target && ev.target.tagName) || '';
    if (tag === 'INPUT' || tag === 'TEXTAREA') return;
    if (ev.code === 'Space' || ev.code === 'Enter') {
      ev.preventDefault();
      showRandom();
    }
  });

  // initial render
  updateCount();
  // show an initial random letter
  showRandom();

  // expose for console debugging (optional)
  window.flashcards = {
    showRandom, resetToDefault, get items(){ return items; }, setItems(arr){ items = arr; updateCount(); }
  };
})();
</script>
</body>
</html>
